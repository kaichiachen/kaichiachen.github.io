<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>資料儲存的基礎知識 - 塊儲存, 檔案儲存, 物件儲存 | 我的生活記事</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="description" content="
塊儲存(Block storage)

塊儲存是最基本的儲存系統, 所以讓我們從這裡開始">
  
  
    <link rel="alternate" href="../../../../atom.xml" title="我的生活記事" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="../../../../favicon.ico">
  
  
    
<link rel="stylesheet" href="../../../../fancybox/jquery.fancybox-1.3.4.css">

  
  
<link rel="stylesheet" href="../../../../css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="../../../../index.html" id="logo">我的生活記事</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="../../../../index.html" id="subtitle">記錄心情生活的地方</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="../../../../index.html">Home</a>
        
          <a class="main-nav-link" href="../../../../archives">Archives</a>
        
          <a class="main-nav-link" href="../../../../about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="../../../../atom.xml" title="RSS Feed"></a>
        
      </nav>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-block_file_object_storage" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="" class="article-date">
  <time class="dt-published" datetime="2021-12-10T16:00:00.000Z" itemprop="datePublished">2021-12-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="../../../../categories/%E5%84%B2%E5%AD%98/">儲存</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      資料儲存的基礎知識 - 塊儲存, 檔案儲存, 物件儲存
    </h1>
  

      </header>
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ol>
<li>塊儲存(Block storage)</li>
</ol>
<p>塊儲存是最基本的儲存系統, 所以讓我們從這裡開始</p>
<span id="more"></span>
<p>我們都知道資料是以1和0儲存在某個&quot;介質&quot;上面, 例如機械式硬碟(HDD)利用磁性, 而固態硬碟(SSD)利用電子, 而塊儲存簡單來說就是我們能看到的一塊塊的硬碟</p>
<p>接下來, 我們有了作業系統, 才能把資料存進去硬碟了, 那麼回答一個問題, 作業系統是如何與硬碟打交道呢? 首先, 作業系統利用LUN ID識別硬碟, LUN是一個或一組或半個硬碟的邏輯代號, 為何有半個呢? 例如我們的windows有一個硬碟, 把他分成C槽和D槽, 那麼他們就是各半個, LUN他不是獨佔式的, 也方便了多台主機共享一個儲存設備</p>
<p>最後, 為什麼叫做block呢? 因為資料的讀取和寫入都是以block為最小單位, 一個block是一段固定長度的bytes, 大約是512, 這樣的設定能提升資料讀寫的速度</p>
<p><strong>優點</strong><br>
塊儲存最大的優點就是他使得計算與儲存分離, 我們能輕易地透過LUN ID外接一個硬碟或硬碟組</p>
<ul>
<li>高性能:<br>
IOPS(Inputs Outputs per Seconds)高, 延遲低, 適合用作database server</li>
<li>易於修改:<br>
如果想改變文件裡的一個小部分資料, 直接改那個block就可以, 如果是文件系統或object system, 需要整個file或object都改</li>
<li>擴充容易:<br>
擴充非常簡單, 一個LUN ID就可以接上系統了, 較沒有性能瓶頸</li>
</ul>
<p><strong>缺點</strong></p>
<ul>
<li>不能同時讀寫:<br>
不能多台機器同時讀寫同一塊硬碟, 雖然可以透過軟體解決此問題但是會造成性能下降</li>
<li>Metadata:<br>
沒有什麼metadata, 檔案系統有檔案路徑、名字、大小等等快速定位資料, 塊儲存只有地址起始位置(LBA)、長度</li>
</ul>
<ol start="2">
<li>檔案儲存(File storage)</li>
</ol>
<p>如果要和硬碟直接打交道, 塊儲存是唯一的方式, 只是對人非常不友好, 我們怎麼知道我的資料存在哪裏? 是連續的存呢? 還是分散的存? 如果每筆資料都連續的存, 那肯定對硬碟的利用率不友好</p>
<p>任何架構的難題只需要加一層就可以解決, 如果不行, 那就兩層, 為了讓人能夠輕鬆的操作儲存資料, 我們在塊儲存上面加了一層檔案系統</p>
<p>我們平常用的Windows就檔案系統, 這大家應該很熟悉, 由於檔案系統就是塊儲存上面加一層, 所以檔案的內容都是存在一個個的block中</p>
<p>除了檔案的內容之外, 文件的metadata比如創建時間、權限、大小等等也需要存在另一個地方, 專門存這些文件metadata的就叫做inode</p>
<p>一個檔案的inode可以透過stat來查詢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#&gt; stat demo.txt                                                                         </span><br><span class="line">  File: ‘demo.txt’</span><br><span class="line">  Size: 12        	Blocks: 8          IO Block: 4096   regular file</span><br><span class="line">Device: fd02h/64770d	Inode: 238749826   Links: 1</span><br><span class="line">Access: (0644/-rw-r--r--)  Uid: (51426876/ ckaijia)   Gid: (  201/     mts)</span><br><span class="line">Access: 2021-08-28 07:27:02.001795167 -0700</span><br><span class="line">Modify: 2021-08-28 07:27:02.001795167 -0700</span><br><span class="line">Change: 2021-08-28 07:27:02.001795167 -0700</span><br><span class="line"> Birth: -</span><br></pre></td></tr></table></figure>
<p>inode也會消耗儲存空間, 所以格式化硬碟的時候, 作業系統會將硬碟分成兩個區域, 一個存數據, 一個存inode, 並且指定一個inode的大小, 所以就算檔案很小, 一塊硬碟裡還是有檔案數量的限制</p>
<p>那作業系統是如何讀取檔案資料呢?</p>
<p>首先, 不是透過檔案名字, 文件名字只是讓使用者方便識別, 作業系統透過inode ID, 每個inode都有一個號碼, 根據使用者點開的文件找到inode號碼, 可以透過<code>ls -i demo.txt</code>看到對應的inode號碼</p>
<p>第二, 根據inode號碼找到inode的data</p>
<p>最後, 根據indoe的data, 找到檔案裡的數據存在哪個block</p>
<p><strong>優點</strong><br>
檔案系統最大的優點就是他對人類友好, 有目錄結構、好記得名字等等, 方便UI呈現, 除此之外還有如下優點</p>
<ul>
<li>方便共享:<br>
一個inode就能與其他同台電腦上的user直接分享檔案, 而且有權限控制</li>
<li>安全:<br>
如上述所示, Linux有三種權限控制 - 自己、組和其他</li>
<li>成本低:<br>
不需要昂貴的光纖, 只要買機器, 接上外接硬碟, 透過作業系統上的檔案系統, 就可以使用</li>
</ul>
<p><strong>缺點</strong></p>
<ul>
<li>資料讀寫慢:<br>
因為讀取跟寫入都有兩層, 除了讀寫本身資料(Block storage)之外, 還有inode裡的metadata需要處理</li>
<li>難以遷移:<br>
如過想把文件都搬遷到另一個作業系統有點困難, 如果file storage的格式不同或inode的演算法不同就更糟了</li>
<li>權限控制:<br>
權限控制只有三層 - 自己、group、others, 無法滿足更複雜的需求</li>
</ul>
<ol start="3">
<li>物件儲存(Object storage)</li>
</ol>
<p>物件儲存和檔案儲存一樣, 是基於塊儲存的, 首先, 與檔案儲存方式不同, 檔案儲存就像是一棵樹, 從點進去一個資料夾開始, 裡面有很多檔案(葉子), 也有資料夾(樹枝), 再點進去資料夾, 又會有檔案、資料夾, 是一個樹狀結構, 物件儲存是扁平化結構, 可以理解為所有檔案都存在一個資料夾裡, 包括Object的metadata, 且資料夾裡不會有資料夾, Object就是一個檔案, 也可以是多個檔案的非結構化組合</p>
<p>Metadata的部分, 他不像檔案系統是固定的inode資料結構, 物件儲存可以隨意自己定義metadata的資料結構, 可以非常詳細以幫助快速檢索目標object</p>
<p>綜上所述, 物件儲存非常適合存靜態不常使用的大數據, 例如大量的影片、音樂等等, 為使用者提供大量、安全、低成本的資料儲存服務</p>
<p>從high level講, 也就是使用方式講, 物件儲存是透過http API對資料進行增刪改查, 與檔案系統API和塊儲存的SCSI不同, Object storage更加方便各個語言的使用</p>
<p>正因為他的扁平化架構, 他天生就適合作為分散式儲存的儲存方式, 為何這麼說呢? 首先, 分散式儲存必須要 “方便” 分散且&quot;容易&quot;伸縮, 由於是扁平化架構, 我們容易把object切塊平均分散在不同機器, 伸縮也非常方便, 加了一台機器, 等於對這個 “資料夾” 加大了空間</p>
<p>加了機器除了可以提升儲存空間之外, 還能提升數據的” 安全性 “, 例如一個object, 我可以複製兩份, 這樣我們可以說他的空間使用率是200%, 保護力是1, 因為他容許一台機器掛掉資料還在, 雖然這種保護方法直觀簡單, 但是現在各大雲端廠商為了節省成本, 透過一些奇偶校驗法會使用例如Raid5這種空間使用率只要150%, 但是保護力也有1</p>
<p><strong>優點</strong></p>
<ul>
<li>方便擴增:<br>
由於物件儲存是扁平化架構, 只要增加機器就是增加這個大平面的面積, 不需要額外修改架構</li>
<li>成本低:<br>
公有雲端上的物件儲存都特別便宜, 例如Amazon S3</li>
<li>API 簡單:<br>
單純的使用HTTP進行增刪改查, 進而支持長距離使用, 例如你在台灣可以使用位在美國的Amazon S3儲存服務</li>
</ul>
<p><strong>缺點</strong></p>
<ul>
<li>不能修改:<br>
由於最小單位就是一個Object, 所以想要修改一個Object代表上穿一個新的替換他, 在文件系統還能在末尾增加一行數據</li>
<li>無法和database整合:<br>
傳統的database是結構化數據, 例如SQL, Mysql等等, 而object storage存放的主要是非結構化數據, 且object storage的讀寫慢</li>
<li>無法與一般作業系統整合:<br>
因為一般的作業系統都是檔案系統, 下載一個object就像是下載一個檔案</li>
</ul>

      
    </div>
    <footer class="article-footer">
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/%E5%A1%8A%E5%84%B2%E5%AD%98/" rel="tag">塊儲存</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/%E6%AA%94%E6%A1%88%E5%84%B2%E5%AD%98/" rel="tag">檔案儲存</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/%E7%89%A9%E4%BB%B6%E5%84%B2%E5%AD%98/" rel="tag">物件儲存</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="../../../../2013/11/06/hello-world/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">
        
          Hello World
        
      </div>
    </a>
  
</nav>

  
</article>


</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 Kaichia Chen<br>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="../../../../index.html" class="mobile-nav-link">Home</a>
  
    <a href="../../../../archives" class="mobile-nav-link">Archives</a>
  
    <a href="../../../../about" class="mobile-nav-link">About</a>
  
</nav>
    


<script src="../../../../js/jquery-1.4.3.min.js"></script>


  
<script src="../../../../fancybox/jquery.fancybox-1.3.4.js"></script>




<script src="../../../../js/script.js"></script>






<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

  </div>
</body>
</html>