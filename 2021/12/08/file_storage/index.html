<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>資料儲存的基礎知識 - File storage | 我的生活記事</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <meta name="description" content="File storage(檔案系統)
有了File storage, 我們用滑鼠鍵盤就能操控資料">
  
  
    <link rel="alternate" href="../../../../atom.xml" title="我的生活記事" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="../../../../favicon.ico">
  
  
    
<link rel="stylesheet" href="../../../../fancybox/jquery.fancybox-1.3.4.css">

  
  
<link rel="stylesheet" href="../../../../css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="../../../../index.html" id="logo">我的生活記事</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="../../../../index.html" id="subtitle">記錄心情生活的地方</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="../../../../index.html">Home</a>
        
          <a class="main-nav-link" href="../../../../archives">Archives</a>
        
          <a class="main-nav-link" href="../../../../about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="../../../../atom.xml" title="RSS Feed"></a>
        
      </nav>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-file_storage" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="" class="article-date">
  <time class="dt-published" datetime="2021-12-07T16:00:00.000Z" itemprop="datePublished">2021-12-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="../../../../categories/%E5%84%B2%E5%AD%98/">儲存</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      資料儲存的基礎知識 - File storage
    </h1>
  

      </header>
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="file-storage(檔案系統)">File storage(檔案系統)</h3>
<p>有了File storage, 我們用滑鼠鍵盤就能操控資料</p>
<span id="more"></span>
<p>如果要和硬碟直接打交道, Block storage是唯一的方式, 只是對人非常不友好, 我們怎麼知道我的資料存在哪裏? 是連續的存呢? 還是分散的存? 如果每筆資料都連續的存, 那肯定對硬碟的利用率不友好</p>
<p>任何架構的難題只需要加一層就可以解決, 如果不行, 那就兩層, 為了讓人能夠輕鬆的操作儲存資料, 我們在Block storage上面加了一層File system</p>
<p>我們平常用的Windows就File system, 這大家應該很熟悉, 由於File system就是Block storage上面加一層, 所以檔案的內容都是存在一個個的block中</p>
<p>除了檔案的內容之外, 文件的metadata比如創建時間、權限、大小等等也需要存在另一個地方, 專門存這些文件metadata的就叫做inode</p>
<p>一個檔案的inode可以透過stat來查詢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#&gt; stat demo.txt</span><br><span class="line">  File: ‘demo.txt’</span><br><span class="line">  Size: 12        	Blocks: 8          IO Block: 4096   regular file</span><br><span class="line">Device: fd02h/64770d	Inode: 238749826   Links: 1</span><br><span class="line">Access: (0644/-rw-r--r--)  Uid: (51426876/ ckaijia)   Gid: (  201/     mts)</span><br><span class="line">Access: 2021-08-28 07:27:02.001795167 -0700</span><br><span class="line">Modify: 2021-08-28 07:27:02.001795167 -0700</span><br><span class="line">Change: 2021-08-28 07:27:02.001795167 -0700</span><br><span class="line"> Birth: -</span><br></pre></td></tr></table></figure>
<p>inode也會消耗儲存空間, 所以格式化硬碟的時候, 作業系統會將硬碟分成兩個區域, 一個存數據, 一個存inode, 並且指定一個inode的大小, 所以就算檔案很小, 一塊硬碟裡還是有檔案數量的限制</p>
<p>那作業系統是如何讀取檔案資料呢?</p>
<p>首先, 不是透過檔案名字, 文件名字只是讓使用者方便識別, 作業系統透過inode ID, 每個inode都有一個號碼, 根據使用者點開的文件找到inode號碼, 可以透過<code>ls -i demo.txt</code>看到對應的inode號碼</p>
<p>第二, 根據inode號碼找到inode的data</p>
<p>最後, 根據indoe的data, 找到檔案裡的數據存在哪個block</p>
<p><strong>優點</strong><br>
File system最大的優點就是他對人類友好, 有目錄結構、好記得名字等等, 方便UI呈現, 除此之外還有如下優點</p>
<ul>
<li><strong>方便共享</strong>:<br>
一個inode就能與其他同台電腦上的user直接分享檔案, 而且有權限控制</li>
<li><strong>安全</strong>:<br>
如上述所示, Linux有三種權限控制 - 自己、組和其他</li>
<li><strong>成本低</strong>:<br>
不需要昂貴的光纖, 只要買機器, 接上外接硬碟, 透過作業系統上的File system, 就可以使用</li>
</ul>
<p><strong>缺點</strong></p>
<ul>
<li><strong>資料讀寫慢</strong>:<br>
因為讀取跟寫入都有兩層, 除了讀寫本身資料(Block storage)之外, 還有inode裡的metadata需要處理</li>
<li><strong>難以遷移</strong>:<br>
如過想把文件都搬遷到另一個作業系統有點困難, 如果file storage的格式不同或inode的演算法不同就更糟了</li>
<li><strong>權限控制</strong>:<br>
權限控制只有三層 - 自己、group、others, 無法滿足更複雜的需求</li>
</ul>

      
    </div>
    <footer class="article-footer">
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/file-storage/" rel="tag">file storage</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/file-system/" rel="tag">file system</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/%E6%AA%94%E6%A1%88%E5%84%B2%E5%AD%98/" rel="tag">檔案儲存</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="../../13/object_storage/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          資料儲存的基礎知識 - Object storage
        
      </div>
    </a>
  
  
    <a href="../../05/block_storage/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">
        
          資料儲存的基礎知識 - Block storage
        
      </div>
    </a>
  
</nav>

  
</article>


</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 Kaichia Chen<br>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="../../../../index.html" class="mobile-nav-link">Home</a>
  
    <a href="../../../../archives" class="mobile-nav-link">Archives</a>
  
    <a href="../../../../about" class="mobile-nav-link">About</a>
  
</nav>
    


<script src="../../../../js/jquery-1.4.3.min.js"></script>


  
<script src="../../../../fancybox/jquery.fancybox-1.3.4.js"></script>




<script src="../../../../js/script.js"></script>






<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

  </div>
</body>
</html>